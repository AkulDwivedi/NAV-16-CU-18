OBJECT Table 5740 Transfer Header
{
  OBJECT-PROPERTIES
  {
    Date=25-08-16;
    Time=12:00:00 PM;
    Version List=NAVW19.00.00.46773,NAVIN9.00.00.46773;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               GetInventorySetup;
               IF "No." = '' THEN BEGIN
                 TestNoSeries;
                 NoSeriesMgt.InitSeries(GetNoSeriesCode,xRec."No. Series","Posting Date","No.","No. Series");
               END;
               InitRecord;
               VALIDATE("Shipment Date",WORKDATE);
             END;

    OnDelete=VAR
               TransLine@1000 : Record 5741;
               InvtCommentLine@1001 : Record 5748;
             BEGIN
               TESTFIELD(Status,Status::Open);

               WhseRequest.SETRANGE("Source Type",DATABASE::"Transfer Line");
               WhseRequest.SETRANGE("Source No.","No.");
               WhseRequest.DELETEALL(TRUE);

               HandleItemTrackingDeletion;
               TransLine.SETRANGE("Document No.","No.");
               TransLine.DELETEALL(TRUE);

               InvtCommentLine.SETRANGE("Document Type",InvtCommentLine."Document Type"::"Transfer Order");
               InvtCommentLine.SETRANGE("No.","No.");
               InvtCommentLine.DELETEALL;

               StrOrder.SETRANGE(Type,StrOrder.Type::Transfer);
               StrOrder.SETRANGE("Structure Code",Structure);
               StrOrder.SETRANGE("Document No.","No.");
               IF StrOrder.FINDFIRST THEN
                 StrOrder.DELETEALL;

               StrOrderLine.SETCURRENTKEY("Document Type","Document No.",Type);
               StrOrderLine.SETRANGE("Document No.","No.");
               StrOrderLine.SETRANGE(Type,StrOrder.Type::Transfer);
               StrOrderLine.SETRANGE("Structure Code",Structure);
               IF StrOrderLine.FINDFIRST THEN
                 StrOrderLine.DELETEALL;

               GateEntryAttachment2.RESET;
               GateEntryAttachment2.SETRANGE("Source Type",GateEntryAttachment2."Source Type"::"Transfer Receipt");
               GateEntryAttachment2.SETRANGE("Entry Type",GateEntryAttachment2."Entry Type"::Inward);
               GateEntryAttachment2.SETRANGE("Source No.","No.");
               GateEntryAttachment2.DELETEALL;
             END;

    OnRename=BEGIN
               ERROR(Text000,TABLECAPTION);
             END;

    CaptionML=[ENU=Transfer Header;
               ENN=Transfer Header];
    LookupPageID=Page5742;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  GetInventorySetup;
                                                                  NoSeriesMgt.TestManual(GetNoSeriesCode);
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              ENN=No.] }
    { 2   ;   ;Transfer-from Code  ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No),
                                                                                 Subcontracting Location=CONST(No));
                                                   OnValidate=VAR
                                                                Location@1000 : Record 14;
                                                                Confirmed@1001 : Boolean;
                                                              BEGIN
                                                                TestStatusOpen;
                                                                IF ("Transfer-from Code" = "Transfer-to Code") AND
                                                                   ("Transfer-from Code" <> '')
                                                                THEN
                                                                  ERROR(
                                                                    Text001,
                                                                    FIELDCAPTION("Transfer-from Code"),FIELDCAPTION("Transfer-to Code"),
                                                                    TABLECAPTION,"No.");
                                                                IF xRec."Transfer-from Code" <> "Transfer-from Code" THEN BEGIN
                                                                  IF HideValidationDialog OR
                                                                     (xRec."Transfer-from Code" = '')
                                                                  THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text002,FALSE,FIELDCAPTION("Transfer-from Code"));
                                                                  IF Confirmed THEN BEGIN
                                                                    IF Location.GET("Transfer-from Code") THEN BEGIN
                                                                      "Transfer-from Name" := Location.Name;
                                                                      "Transfer-from Name 2" := Location."Name 2";
                                                                      "Transfer-from Address" := Location.Address;
                                                                      "Transfer-from Address 2" := Location."Address 2";
                                                                      "Transfer-from Post Code" := Location."Post Code";
                                                                      "Transfer-from City" := Location.City;
                                                                      "Transfer-from County" := Location.County;
                                                                      "Trsf.-from Country/Region Code" := Location."Country/Region Code";
                                                                      "Transfer-from Contact" := Location.Contact;
                                                                      "Excise Bus. Posting Group" := Location."Excise Bus. Posting Group";
                                                                      "Outbound Whse. Handling Time" := Location."Outbound Whse. Handling Time";
                                                                      TransferRoute.GetTransferRoute(
                                                                        "Transfer-from Code","Transfer-to Code","In-Transit Code",
                                                                        "Shipping Agent Code","Shipping Agent Service Code");
                                                                      TransferRoute.GetShippingTime(
                                                                        "Transfer-from Code","Transfer-to Code",
                                                                        "Shipping Agent Code","Shipping Agent Service Code",
                                                                        "Shipping Time");
                                                                      TransferRoute.CalcReceiptDate(
                                                                        "Shipment Date",
                                                                        "Receipt Date",
                                                                        "Shipping Time",
                                                                        "Outbound Whse. Handling Time",
                                                                        "Inbound Whse. Handling Time",
                                                                        "Transfer-from Code",
                                                                        "Transfer-to Code",
                                                                        "Shipping Agent Code",
                                                                        "Shipping Agent Service Code");
                                                                      TransLine.LOCKTABLE;
                                                                      TransLine.SETRANGE("Document No.","No.");
                                                                      IF TransLine.FINDSET THEN;
                                                                      MODIFY;
                                                                    END;
                                                                    UpdateTransLines(FIELDNO("Transfer-from Code"));
                                                                  END ELSE BEGIN
                                                                    "Transfer-from Code" := xRec."Transfer-from Code";
                                                                    EXIT;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Transfer-from Code;
                                                              ENN=Transfer-from Code] }
    { 3   ;   ;Transfer-from Name  ;Text50        ;CaptionML=[ENU=Transfer-from Name;
                                                              ENN=Transfer-from Name] }
    { 4   ;   ;Transfer-from Name 2;Text50        ;CaptionML=[ENU=Transfer-from Name 2;
                                                              ENN=Transfer-from Name 2] }
    { 5   ;   ;Transfer-from Address;Text50       ;CaptionML=[ENU=Transfer-from Address;
                                                              ENN=Transfer-from Address] }
    { 6   ;   ;Transfer-from Address 2;Text50     ;CaptionML=[ENU=Transfer-from Address 2;
                                                              ENN=Transfer-from Address 2] }
    { 7   ;   ;Transfer-from Post Code;Code20     ;TableRelation=IF (Trsf.-from Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Trsf.-from Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Trsf.-from Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Transfer-from City","Transfer-from Post Code",
                                                                  "Transfer-from County","Trsf.-from Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Transfer-from Post Code;
                                                              ENN=Transfer-from Post Code] }
    { 8   ;   ;Transfer-from City  ;Text30        ;TableRelation=IF (Trsf.-from Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Trsf.-from Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Trsf.-from Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Transfer-from City","Transfer-from Post Code",
                                                                  "Transfer-from County","Trsf.-from Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Transfer-from City;
                                                              ENN=Transfer-from City] }
    { 9   ;   ;Transfer-from County;Text30        ;CaptionML=[ENU=Transfer-from County;
                                                              ENN=Transfer-from County] }
    { 10  ;   ;Trsf.-from Country/Region Code;Code10;
                                                   TableRelation=Country/Region;
                                                   CaptionML=[ENU=Trsf.-from Country/Region Code;
                                                              ENN=Trsf.-from Country/Region Code] }
    { 11  ;   ;Transfer-to Code    ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No),
                                                                                 Subcontracting Location=CONST(No));
                                                   OnValidate=VAR
                                                                Location@1000 : Record 14;
                                                                Confirmed@1001 : Boolean;
                                                              BEGIN
                                                                TestStatusOpen;
                                                                IF ("Transfer-from Code" = "Transfer-to Code") AND
                                                                   ("Transfer-to Code" <> '')
                                                                THEN
                                                                  ERROR(
                                                                    Text001,
                                                                    FIELDCAPTION("Transfer-from Code"),FIELDCAPTION("Transfer-to Code"),
                                                                    TABLECAPTION,"No.");
                                                                IF xRec."Transfer-to Code" <> "Transfer-to Code" THEN BEGIN
                                                                  IF HideValidationDialog OR
                                                                     (xRec."Transfer-to Code" = '')
                                                                  THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text002,FALSE,FIELDCAPTION("Transfer-to Code"));
                                                                  IF Confirmed THEN BEGIN
                                                                    IF Location.GET("Transfer-to Code") THEN BEGIN
                                                                      "Transfer-to Name" := Location.Name;
                                                                      "Transfer-to Name 2" := Location."Name 2";
                                                                      "Transfer-to Address" := Location.Address;
                                                                      "Transfer-to Address 2" := Location."Address 2";
                                                                      "Transfer-to Post Code" := Location."Post Code";
                                                                      "Transfer-to City" := Location.City;
                                                                      "Transfer-to County" := Location.County;
                                                                      "Trsf.-to Country/Region Code" := Location."Country/Region Code";
                                                                      "Transfer-to Contact" := Location.Contact;
                                                                      "Inbound Whse. Handling Time" := Location."Inbound Whse. Handling Time";
                                                                      TransferRoute.GetTransferRoute(
                                                                        "Transfer-from Code","Transfer-to Code","In-Transit Code",
                                                                        "Shipping Agent Code","Shipping Agent Service Code");
                                                                      TransferRoute.GetShippingTime(
                                                                        "Transfer-from Code","Transfer-to Code",
                                                                        "Shipping Agent Code","Shipping Agent Service Code",
                                                                        "Shipping Time");
                                                                      TransferRoute.CalcReceiptDate(
                                                                        "Shipment Date",
                                                                        "Receipt Date",
                                                                        "Shipping Time",
                                                                        "Outbound Whse. Handling Time",
                                                                        "Inbound Whse. Handling Time",
                                                                        "Transfer-from Code",
                                                                        "Transfer-to Code",
                                                                        "Shipping Agent Code",
                                                                        "Shipping Agent Service Code");
                                                                      TransLine.LOCKTABLE;
                                                                      TransLine.SETRANGE("Document No.","No.");
                                                                      IF TransLine.FINDSET THEN;
                                                                      MODIFY;
                                                                    END;
                                                                    UpdateTransLines(FIELDNO("Transfer-to Code"));
                                                                  END ELSE BEGIN
                                                                    "Transfer-to Code" := xRec."Transfer-to Code";
                                                                    EXIT;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Transfer-to Code;
                                                              ENN=Transfer-to Code] }
    { 12  ;   ;Transfer-to Name    ;Text50        ;CaptionML=[ENU=Transfer-to Name;
                                                              ENN=Transfer-to Name] }
    { 13  ;   ;Transfer-to Name 2  ;Text50        ;CaptionML=[ENU=Transfer-to Name 2;
                                                              ENN=Transfer-to Name 2] }
    { 14  ;   ;Transfer-to Address ;Text50        ;CaptionML=[ENU=Transfer-to Address;
                                                              ENN=Transfer-to Address] }
    { 15  ;   ;Transfer-to Address 2;Text50       ;CaptionML=[ENU=Transfer-to Address 2;
                                                              ENN=Transfer-to Address 2] }
    { 16  ;   ;Transfer-to Post Code;Code20       ;TableRelation="Post Code";
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Transfer-to City","Transfer-to Post Code","Transfer-to County",
                                                                  "Trsf.-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Transfer-to Post Code;
                                                              ENN=Transfer-to Post Code] }
    { 17  ;   ;Transfer-to City    ;Text30        ;TableRelation=IF (Trsf.-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Trsf.-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Trsf.-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Transfer-to City","Transfer-to Post Code","Transfer-to County",
                                                                  "Trsf.-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Transfer-to City;
                                                              ENN=Transfer-to City] }
    { 18  ;   ;Transfer-to County  ;Text30        ;CaptionML=[ENU=Transfer-to County;
                                                              ENN=Transfer-to County] }
    { 19  ;   ;Trsf.-to Country/Region Code;Code10;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Trsf.-to Country/Region Code;
                                                              ENN=Trsf.-to Country/Region Code] }
    { 20  ;   ;Posting Date        ;Date          ;CaptionML=[ENU=Posting Date;
                                                              ENN=Posting Date] }
    { 21  ;   ;Shipment Date       ;Date          ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                TransferRoute.CalcReceiptDate(
                                                                  "Shipment Date",
                                                                  "Receipt Date",
                                                                  "Shipping Time",
                                                                  "Outbound Whse. Handling Time",
                                                                  "Inbound Whse. Handling Time",
                                                                  "Transfer-from Code",
                                                                  "Transfer-to Code",
                                                                  "Shipping Agent Code",
                                                                  "Shipping Agent Service Code");
                                                                UpdateTransLines(FIELDNO("Shipment Date"));
                                                              END;

                                                   CaptionML=[ENU=Shipment Date;
                                                              ENN=Shipment Date] }
    { 22  ;   ;Receipt Date        ;Date          ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                TransferRoute.CalcShipmentDate(
                                                                  "Shipment Date",
                                                                  "Receipt Date",
                                                                  "Shipping Time",
                                                                  "Outbound Whse. Handling Time",
                                                                  "Inbound Whse. Handling Time",
                                                                  "Transfer-from Code",
                                                                  "Transfer-to Code",
                                                                  "Shipping Agent Code",
                                                                  "Shipping Agent Service Code");
                                                                UpdateTransLines(FIELDNO("Receipt Date"));
                                                              END;

                                                   CaptionML=[ENU=Receipt Date;
                                                              ENN=Receipt Date] }
    { 23  ;   ;Status              ;Option        ;OnValidate=BEGIN
                                                                UpdateTransLines(FIELDNO(Status));
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              ENN=Status];
                                                   OptionCaptionML=[ENU=Open,Released;
                                                                    ENN=Open,Released];
                                                   OptionString=Open,Released;
                                                   Editable=No }
    { 24  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Inventory Comment Line" WHERE (Document Type=CONST(Transfer Order),
                                                                                                     No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              ENN=Comment];
                                                   Editable=No }
    { 25  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              ENN=Shortcut Dimension 1 Code];
                                                   CaptionClass='1,2,1' }
    { 26  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              ENN=Shortcut Dimension 2 Code];
                                                   CaptionClass='1,2,2' }
    { 27  ;   ;In-Transit Code     ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(Yes));
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                UpdateTransLines(FIELDNO("In-Transit Code"));
                                                              END;

                                                   CaptionML=[ENU=In-Transit Code;
                                                              ENN=In-Transit Code] }
    { 28  ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              ENN=No. Series] }
    { 29  ;   ;Last Shipment No.   ;Code20        ;TableRelation="Transfer Shipment Header";
                                                   CaptionML=[ENU=Last Shipment No.;
                                                              ENN=Last Shipment No.];
                                                   Editable=No }
    { 30  ;   ;Last Receipt No.    ;Code20        ;TableRelation="Transfer Receipt Header";
                                                   CaptionML=[ENU=Last Receipt No.;
                                                              ENN=Last Receipt No.];
                                                   Editable=No }
    { 31  ;   ;Transfer-from Contact;Text50       ;CaptionML=[ENU=Transfer-from Contact;
                                                              ENN=Transfer-from Contact] }
    { 32  ;   ;Transfer-to Contact ;Text50        ;CaptionML=[ENU=Transfer-to Contact;
                                                              ENN=Transfer-to Contact] }
    { 33  ;   ;External Document No.;Code35       ;CaptionML=[ENU=External Document No.;
                                                              ENN=External Document No.] }
    { 34  ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF "Shipping Agent Code" <> xRec."Shipping Agent Code" THEN
                                                                  VALIDATE("Shipping Agent Service Code",'');
                                                                UpdateTransLines(FIELDNO("Shipping Agent Code"));
                                                              END;

                                                   AccessByPermission=TableData 5790=R;
                                                   CaptionML=[ENU=Shipping Agent Code;
                                                              ENN=Shipping Agent Code] }
    { 35  ;   ;Shipping Agent Service Code;Code10 ;TableRelation="Shipping Agent Services".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code));
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                TransferRoute.GetShippingTime(
                                                                  "Transfer-from Code","Transfer-to Code",
                                                                  "Shipping Agent Code","Shipping Agent Service Code",
                                                                  "Shipping Time");
                                                                TransferRoute.CalcReceiptDate(
                                                                  "Shipment Date",
                                                                  "Receipt Date",
                                                                  "Shipping Time",
                                                                  "Outbound Whse. Handling Time",
                                                                  "Inbound Whse. Handling Time",
                                                                  "Transfer-from Code",
                                                                  "Transfer-to Code",
                                                                  "Shipping Agent Code",
                                                                  "Shipping Agent Service Code");

                                                                UpdateTransLines(FIELDNO("Shipping Agent Service Code"));
                                                              END;

                                                   CaptionML=[ENU=Shipping Agent Service Code;
                                                              ENN=Shipping Agent Service Code] }
    { 36  ;   ;Shipping Time       ;DateFormula   ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                TransferRoute.CalcReceiptDate(
                                                                  "Shipment Date",
                                                                  "Receipt Date",
                                                                  "Shipping Time",
                                                                  "Outbound Whse. Handling Time",
                                                                  "Inbound Whse. Handling Time",
                                                                  "Transfer-from Code",
                                                                  "Transfer-to Code",
                                                                  "Shipping Agent Code",
                                                                  "Shipping Agent Service Code");

                                                                UpdateTransLines(FIELDNO("Shipping Time"));
                                                              END;

                                                   AccessByPermission=TableData 5790=R;
                                                   CaptionML=[ENU=Shipping Time;
                                                              ENN=Shipping Time] }
    { 37  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   CaptionML=[ENU=Shipment Method Code;
                                                              ENN=Shipment Method Code] }
    { 47  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   CaptionML=[ENU=Transaction Type;
                                                              ENN=Transaction Type] }
    { 48  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   CaptionML=[ENU=Transport Method;
                                                              ENN=Transport Method] }
    { 59  ;   ;Entry/Exit Point    ;Code10        ;TableRelation="Entry/Exit Point";
                                                   CaptionML=[ENU=Entry/Exit Point;
                                                              ENN=Entry/Exit Point] }
    { 63  ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   CaptionML=[ENU=Area;
                                                              ENN=Area] }
    { 64  ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   CaptionML=[ENU=Transaction Specification;
                                                              ENN=Transaction Specification] }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDocDim;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              ENN=Dimension Set ID];
                                                   Editable=No }
    { 5750;   ;Shipping Advice     ;Option        ;OnValidate=BEGIN
                                                                IF "Shipping Advice" <> xRec."Shipping Advice" THEN BEGIN
                                                                  TestStatusOpen;
                                                                  WhseSourceHeader.TransHeaderVerifyChange(Rec,xRec);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Shipping Advice;
                                                              ENN=Shipping Advice];
                                                   OptionCaptionML=[ENU=Partial,Complete;
                                                                    ENN=Partial,Complete];
                                                   OptionString=Partial,Complete }
    { 5751;   ;Posting from Whse. Ref.;Integer    ;CaptionML=[ENU=Posting from Whse. Ref.;
                                                              ENN=Posting from Whse. Ref.] }
    { 5752;   ;Completely Shipped  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Min("Transfer Line"."Completely Shipped" WHERE (Document No.=FIELD(No.),
                                                                                                               Shipment Date=FIELD(Date Filter),
                                                                                                               Transfer-from Code=FIELD(Location Filter),
                                                                                                               Derived From Line No.=CONST(0)));
                                                   CaptionML=[ENU=Completely Shipped;
                                                              ENN=Completely Shipped];
                                                   Editable=No }
    { 5753;   ;Completely Received ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Min("Transfer Line"."Completely Received" WHERE (Document No.=FIELD(No.),
                                                                                                                Receipt Date=FIELD(Date Filter),
                                                                                                                Transfer-to Code=FIELD(Location Filter),
                                                                                                                Derived From Line No.=CONST(0)));
                                                   CaptionML=[ENU=Completely Received;
                                                              ENN=Completely Received];
                                                   Editable=No }
    { 5754;   ;Location Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Location;
                                                   CaptionML=[ENU=Location Filter;
                                                              ENN=Location Filter] }
    { 5793;   ;Outbound Whse. Handling Time;DateFormula;
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                TransferRoute.CalcReceiptDate(
                                                                  "Shipment Date",
                                                                  "Receipt Date",
                                                                  "Shipping Time",
                                                                  "Outbound Whse. Handling Time",
                                                                  "Inbound Whse. Handling Time",
                                                                  "Transfer-from Code",
                                                                  "Transfer-to Code",
                                                                  "Shipping Agent Code",
                                                                  "Shipping Agent Service Code");

                                                                UpdateTransLines(FIELDNO("Outbound Whse. Handling Time"));
                                                              END;

                                                   CaptionML=[ENU=Outbound Whse. Handling Time;
                                                              ENN=Outbound Whse. Handling Time] }
    { 5794;   ;Inbound Whse. Handling Time;DateFormula;
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                TransferRoute.CalcReceiptDate(
                                                                  "Shipment Date",
                                                                  "Receipt Date",
                                                                  "Shipping Time",
                                                                  "Outbound Whse. Handling Time",
                                                                  "Inbound Whse. Handling Time",
                                                                  "Transfer-from Code",
                                                                  "Transfer-to Code",
                                                                  "Shipping Agent Code",
                                                                  "Shipping Agent Service Code");

                                                                UpdateTransLines(FIELDNO("Inbound Whse. Handling Time"));
                                                              END;

                                                   CaptionML=[ENU=Inbound Whse. Handling Time;
                                                              ENN=Inbound Whse. Handling Time] }
    { 5796;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              ENN=Date Filter] }
    { 9000;   ;Assigned User ID    ;Code50        ;TableRelation="User Setup";
                                                   CaptionML=[ENU=Assigned User ID;
                                                              ENN=Assigned User ID] }
    { 13707;  ;Excise Bus. Posting Group;Code10   ;TableRelation="Excise Bus. Posting Group";
                                                   CaptionML=[ENU=Excise Bus. Posting Group;
                                                              ENN=Excise Bus. Posting Group] }
    { 13723;  ;Form Code           ;Code10        ;TableRelation="Form Codes";
                                                   CaptionML=[ENU=Form Code;
                                                              ENN=Form Code] }
    { 13724;  ;Form No.            ;Code10        ;TableRelation="Tax Forms Details"."Form No." WHERE (Form Code=FIELD(Form Code));
                                                   CaptionML=[ENU=Form No.;
                                                              ENN=Form No.] }
    { 13750;  ;Structure           ;Code10        ;TableRelation="Structure Header".Code;
                                                   OnValidate=VAR
                                                                Text13700@1280004 : TextConst 'ENU=Structure code cannot be changed.;ENN=Structure code cannot be changed.';
                                                                StrDetails@1280003 : Record 13793;
                                                                StrOrderDetails@1280002 : Record 13794;
                                                                StrOrderLines@1280001 : Record 13795;
                                                                TransLines@1280000 : Record 5741;
                                                              BEGIN
                                                                IF GoodsShipped THEN
                                                                  ERROR(Text13700);

                                                                StrOrderDetails.SETCURRENTKEY("Document Type","Document No.",Type);
                                                                StrOrderDetails.SETRANGE("Document No.","No.");
                                                                StrOrderDetails.SETRANGE(Type,StrOrderDetails.Type::Transfer);
                                                                IF StrOrderDetails.FINDFIRST THEN
                                                                  StrOrderDetails.DELETEALL;

                                                                StrOrderLines.SETCURRENTKEY("Document Type","Document No.",Type);
                                                                StrOrderLines.SETRANGE("Document No.","No.");
                                                                StrOrderLines.SETRANGE(Type,StrOrderLines.Type::Transfer);
                                                                IF StrOrderLines.FINDFIRST THEN
                                                                  StrOrderLines.DELETEALL;

                                                                TransLines.ResetStructureAmounts(Rec);

                                                                StrDetails.RESET;
                                                                StrDetails.SETRANGE(Code,Structure);
                                                                IF StrDetails.FIND('-') THEN
                                                                  REPEAT
                                                                    StrOrderDetails.Type := StrOrderDetails.Type::Transfer;
                                                                    StrOrderDetails."Document No." := "No.";
                                                                    StrOrderDetails."Structure Code" := Structure;
                                                                    StrOrderDetails."Calculation Order" := StrDetails."Calculation Order";
                                                                    StrOrderDetails."Tax/Charge Type" := StrDetails.Type;
                                                                    StrOrderDetails."Tax/Charge Group" := StrDetails."Tax/Charge Group";
                                                                    StrOrderDetails."Tax/Charge Code" := StrDetails."Tax/Charge Code";
                                                                    StrOrderDetails."Calculation Type" := StrDetails."Calculation Type";
                                                                    StrOrderDetails."Calculation Value" := StrDetails."Calculation Value";
                                                                    StrOrderDetails."Quantity Per" := StrDetails."Quantity Per";
                                                                    StrOrderDetails."Loading on Inventory" := StrDetails."Loading on Inventory";
                                                                    StrOrderDetails."% Loading on Inventory" := StrDetails."% Loading on Inventory";
                                                                    StrOrderDetails."Payable to Third Party" := StrDetails."Payable to Third Party";
                                                                    StrOrderDetails."Account No." := StrDetails."Account No.";
                                                                    StrOrderDetails."Base Formula" := StrDetails."Base Formula";
                                                                    StrOrderDetails."Include Base" := StrDetails."Include Base";
                                                                    StrOrderDetails."Include Line Discount" := StrDetails."Include Line Discount";
                                                                    StrOrderDetails."Include Invoice Discount" := StrDetails."Include Invoice Discount";
                                                                    StrOrderDetails."Charge Basis" := StrDetails."Charge Basis";
                                                                    StrOrderDetails."Header/Line" := StrDetails."Header/Line";
                                                                    IF StrDetails.Type = StrDetails.Type::Excise THEN
                                                                      StrOrderDetails.CVD := StrDetails.CVD;
                                                                    StrOrderDetails.INSERT
                                                                  UNTIL StrDetails.NEXT = 0;
                                                              END;

                                                   CaptionML=[ENU=Structure;
                                                              ENN=Structure] }
    { 16503;  ;Captive Consumption ;Boolean       ;CaptionML=[ENU=Captive Consumption;
                                                              ENN=Captive Consumption];
                                                   Editable=No }
    { 16504;  ;Vendor Invoice No.  ;Code20        ;CaptionML=[ENU=Vendor Invoice No.;
                                                              ENN=Vendor Invoice No.] }
    { 16505;  ;Time of Removal     ;Time          ;CaptionML=[ENU=Time of Removal;
                                                              ENN=Time of Removal] }
    { 16506;  ;LR/RR No.           ;Code20        ;CaptionML=[ENU=LR/RR No.;
                                                              ENN=LR/RR No.] }
    { 16507;  ;LR/RR Date          ;Date          ;CaptionML=[ENU=LR/RR Date;
                                                              ENN=LR/RR Date] }
    { 16508;  ;Vehicle No.         ;Code20        ;CaptionML=[ENU=Vehicle No.;
                                                              ENN=Vehicle No.] }
    { 16509;  ;Mode of Transport   ;Text15        ;CaptionML=[ENU=Mode of Transport;
                                                              ENN=Mode of Transport] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Transfer-from Code,Transfer-to Code,Shipment Date,Status }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You cannot rename a %1.;ENN=You cannot rename a %1.';
      Text001@1001 : TextConst 'ENU=%1 and %2 cannot be the same in %3 %4.;ENN=%1 and %2 cannot be the same in %3 %4.';
      Text002@1002 : TextConst 'ENU=Do you want to change %1?;ENN=Do you want to change %1?';
      Text003@1003 : TextConst 'ENU=The transfer order %1 has been deleted.;ENN=The transfer order %1 has been deleted.';
      TransferRoute@1004 : Record 5742;
      TransHeader@1005 : Record 5740;
      TransLine@1016 : Record 5741;
      PostCode@1006 : Record 225;
      InvtSetup@1007 : Record 313;
      WhseRequest@1008 : Record 5765;
      StrOrder@1500001 : Record 13794;
      StrOrderLine@1500000 : Record 13795;
      DimMgt@1009 : Codeunit 408;
      NoSeriesMgt@1010 : Codeunit 396;
      WhseSourceHeader@1011 : Codeunit 5781;
      HideValidationDialog@1013 : Boolean;
      HasInventorySetup@1012 : Boolean;
      CalledFromWhse@1015 : Boolean;
      Text004@1018 : TextConst 'ENU=The transfer order %1 has item tracking. Do you want to delete it anyway?;ENN=The transfer order %1 has item tracking. Do you want to delete it anyway?';
      Text007@1014 : TextConst 'ENU=You may have changed a dimension.\\Do you want to update the lines?;ENN=You may have changed a dimension.\\Do you want to update the lines?';
      PostedGateEntryLine@1500003 : Record 16556;
      GateEntryAttachment@1500004 : Record 16557;
      GateEntryAttachment2@1500002 : Record 16557;
      PostedGateEntryLineList@1500005 : Page 16480;

    PROCEDURE InitRecord@10();
    BEGIN
      IF "Posting Date" = 0D THEN
        VALIDATE("Posting Date",WORKDATE);
      "Time of Removal" := TIME;
    END;

    PROCEDURE AssistEdit@1(OldTransHeader@1000 : Record 5740) : Boolean;
    BEGIN
      WITH TransHeader DO BEGIN
        TransHeader := Rec;
        GetInventorySetup;
        TestNoSeries;
        IF NoSeriesMgt.SelectSeries(GetNoSeriesCode,OldTransHeader."No. Series","No. Series") THEN BEGIN
          NoSeriesMgt.SetSeries("No.");
          Rec := TransHeader;
          EXIT(TRUE);
        END;
      END;
    END;

    LOCAL PROCEDURE TestNoSeries@6() : Boolean;
    BEGIN
      InvtSetup.TESTFIELD("Transfer Order Nos.");
    END;

    LOCAL PROCEDURE GetNoSeriesCode@9() : Code[10];
    BEGIN
      IF NOT "Captive Consumption" THEN
        EXIT(InvtSetup."Transfer Order Nos.");

      EXIT(InvtSetup."Transfer Order Nos. (Captive)");
    END;

    PROCEDURE SetHideValidationDialog@14(NewHideValidationDialog@1000 : Boolean);
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    LOCAL PROCEDURE ValidateShortcutDimCode@19(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      OldDimSetID@1002 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");

      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF TransferLinesExist THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE GetInventorySetup@2();
    BEGIN
      IF NOT HasInventorySetup THEN BEGIN
        InvtSetup.GET;
        HasInventorySetup := TRUE;
      END;
    END;

    LOCAL PROCEDURE UpdateTransLines@15(FieldRef@1000 : Integer);
    VAR
      TransLine@1001 : Record 5741;
    BEGIN
      TransLine.SETRANGE("Document No.","No.");
      TransLine.SETFILTER("Item No.",'<>%1','');
      IF TransLine.FINDSET THEN BEGIN
        TransLine.LOCKTABLE;
        REPEAT
          CASE FieldRef OF
            FIELDNO("In-Transit Code"):
              TransLine.VALIDATE("In-Transit Code","In-Transit Code");
            FIELDNO("Transfer-from Code"):
              BEGIN
                TransLine.VALIDATE("Transfer-from Code","Transfer-from Code");
                TransLine.VALIDATE("Shipping Agent Code","Shipping Agent Code");
                TransLine.VALIDATE("Shipping Agent Service Code","Shipping Agent Service Code");
                TransLine.VALIDATE("Shipment Date","Shipment Date");
                TransLine.VALIDATE("Receipt Date","Receipt Date");
                TransLine.VALIDATE("Shipping Time","Shipping Time");
              END;
            FIELDNO("Transfer-to Code"):
              BEGIN
                TransLine.VALIDATE("Transfer-to Code","Transfer-to Code");
                TransLine.VALIDATE("Shipping Agent Code","Shipping Agent Code");
                TransLine.VALIDATE("Shipping Agent Service Code","Shipping Agent Service Code");
                TransLine.VALIDATE("Shipment Date","Shipment Date");
                TransLine.VALIDATE("Receipt Date","Receipt Date");
                TransLine.VALIDATE("Shipping Time","Shipping Time");
              END;
            FIELDNO("Shipping Agent Code"):
              BEGIN
                TransLine.VALIDATE("Shipping Agent Code","Shipping Agent Code");
                TransLine.BlockDynamicTracking(TRUE);
                TransLine.VALIDATE("Shipping Agent Service Code","Shipping Agent Service Code");
                TransLine.VALIDATE("Shipment Date","Shipment Date");
                TransLine.VALIDATE("Receipt Date","Receipt Date");
                TransLine.VALIDATE("Shipping Time","Shipping Time");
                TransLine.BlockDynamicTracking(FALSE);
                TransLine.DateConflictCheck;
              END;
            FIELDNO("Shipping Agent Service Code"):
              BEGIN
                TransLine.BlockDynamicTracking(TRUE);
                TransLine.VALIDATE("Shipping Agent Service Code","Shipping Agent Service Code");
                TransLine.VALIDATE("Shipment Date","Shipment Date");
                TransLine.VALIDATE("Receipt Date","Receipt Date");
                TransLine.VALIDATE("Shipping Time","Shipping Time");
                TransLine.BlockDynamicTracking(FALSE);
                TransLine.DateConflictCheck;
              END;
            FIELDNO("Shipment Date"):
              BEGIN
                TransLine.BlockDynamicTracking(TRUE);
                TransLine.VALIDATE("Shipment Date","Shipment Date");
                TransLine.VALIDATE("Receipt Date","Receipt Date");
                TransLine.VALIDATE("Shipping Time","Shipping Time");
                TransLine.BlockDynamicTracking(FALSE);
                TransLine.DateConflictCheck;
              END;
            FIELDNO("Receipt Date"),FIELDNO("Shipping Time"):
              BEGIN
                TransLine.BlockDynamicTracking(TRUE);
                TransLine.VALIDATE("Shipping Time","Shipping Time");
                TransLine.VALIDATE("Receipt Date","Receipt Date");
                TransLine.BlockDynamicTracking(FALSE);
                TransLine.DateConflictCheck;
              END;
            FIELDNO("Outbound Whse. Handling Time"):
              TransLine.VALIDATE("Outbound Whse. Handling Time","Outbound Whse. Handling Time");
            FIELDNO("Inbound Whse. Handling Time"):
              TransLine.VALIDATE("Inbound Whse. Handling Time","Inbound Whse. Handling Time");
            FIELDNO(Status):
              TransLine.VALIDATE(Status,Status);
          END;
          TransLine.MODIFY(TRUE);
        UNTIL TransLine.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE HandleItemTrackingDeletion@36();
    VAR
      ReservEntry@1000 : Record 337;
      ReservEntry2@1002 : Record 337;
      Confirmed@1001 : Boolean;
    BEGIN
      WITH ReservEntry DO BEGIN
        RESET;
        SETCURRENTKEY(
          "Source ID","Source Ref. No.","Source Type","Source Subtype",
          "Source Batch Name","Source Prod. Order Line","Reservation Status");
        SETRANGE("Source Type",DATABASE::"Transfer Line");
        SETRANGE("Source ID","No.");
        SETRANGE("Source Batch Name",'');
        SETFILTER("Item Tracking",'> %1',"Item Tracking"::None);
        IF ISEMPTY THEN
          EXIT;

        IF HideValidationDialog OR NOT GUIALLOWED THEN
          Confirmed := TRUE
        ELSE
          Confirmed := CONFIRM(Text004,FALSE,"No.");

        IF NOT Confirmed THEN
          ERROR('');

        IF FINDSET THEN
          REPEAT
            ReservEntry2 := ReservEntry;
            ReservEntry2.ClearItemTrackingFields;
            ReservEntry2.MODIFY;
          UNTIL NEXT = 0;
      END;
    END;

    PROCEDURE DeleteOneTransferOrder@4(VAR TransHeader2@1000 : Record 5740;VAR TransLine2@1001 : Record 5741) : Boolean;
    VAR
      ItemChargeAssgntPurch@1002 : Record 5805;
      WhseRequest@1003 : Record 5765;
      InvtCommentLine@1004 : Record 5748;
      No@1007 : Code[20];
      DoNotDelete@1008 : Boolean;
    BEGIN
      No := TransHeader2."No.";
      IF TransLine2.FIND('-') THEN
        REPEAT
          IF (TransLine2.Quantity <> TransLine2."Quantity Shipped") OR
             (TransLine2.Quantity <> TransLine2."Quantity Received") OR
             (TransLine2."Quantity (Base)" <> TransLine2."Qty. Shipped (Base)") OR
             (TransLine2."Quantity (Base)" <> TransLine2."Qty. Received (Base)") OR
             (TransLine2."Quantity Shipped" <> TransLine2."Quantity Received") OR
             (TransLine2."Qty. Shipped (Base)" <> TransLine2."Qty. Received (Base)")
          THEN
            DoNotDelete := TRUE;
        UNTIL TransLine2.NEXT = 0;

      IF NOT DoNotDelete THEN BEGIN
        WhseRequest.SETRANGE("Source Type",DATABASE::"Transfer Line");
        WhseRequest.SETRANGE("Source No.",No);
        WhseRequest.DELETEALL(TRUE);

        InvtCommentLine.SETRANGE("Document Type",InvtCommentLine."Document Type"::"Transfer Order");
        InvtCommentLine.SETRANGE("No.",No);
        InvtCommentLine.DELETEALL;

        ItemChargeAssgntPurch.SETCURRENTKEY(
          "Applies-to Doc. Type","Applies-to Doc. No.","Applies-to Doc. Line No.");
        ItemChargeAssgntPurch.SETRANGE("Applies-to Doc. Type",ItemChargeAssgntPurch."Applies-to Doc. Type"::"Transfer Receipt");
        ItemChargeAssgntPurch.SETRANGE("Applies-to Doc. No.",TransLine2."Document No.");
        ItemChargeAssgntPurch.DELETEALL;

        IF TransLine2.FIND('-') THEN
          TransLine2.DELETEALL;

        TransHeader2.DELETE;
        IF NOT HideValidationDialog THEN
          MESSAGE(Text003,No);
        EXIT(TRUE);
      END;
      EXIT(FALSE);
    END;

    LOCAL PROCEDURE TestStatusOpen@37();
    BEGIN
      IF NOT CalledFromWhse THEN
        TESTFIELD(Status,Status::Open);
    END;

    PROCEDURE CalledFromWarehouse@7300(CalledFromWhse2@1000 : Boolean);
    BEGIN
      CalledFromWhse := CalledFromWhse2;
    END;

    PROCEDURE CreateInvtPutAwayPick@29();
    VAR
      WhseRequest@1000 : Record 5765;
    BEGIN
      TESTFIELD(Status,Status::Released);

      WhseRequest.RESET;
      WhseRequest.SETCURRENTKEY("Source Document","Source No.");
      WhseRequest.SETFILTER(
        "Source Document",'%1|%2',
        WhseRequest."Source Document"::"Inbound Transfer",
        WhseRequest."Source Document"::"Outbound Transfer");
      WhseRequest.SETRANGE("Source No.","No.");
      REPORT.RUNMODAL(REPORT::"Create Invt Put-away/Pick/Mvmt",TRUE,FALSE,WhseRequest);
    END;

    PROCEDURE ShowDocDim@3();
    VAR
      OldDimSetID@1000 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2("Dimension Set ID",STRSUBSTNO('%1 %2',TABLECAPTION,"No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF TransferLinesExist THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE TransferLinesExist@5() : Boolean;
    BEGIN
      TransLine.RESET;
      TransLine.SETRANGE("Document No.","No.");
      EXIT(TransLine.FINDFIRST);
    END;

    LOCAL PROCEDURE UpdateAllLineDim@34(NewParentDimSetID@1000 : Integer;OldParentDimSetID@1001 : Integer);
    VAR
      NewDimSetID@1002 : Integer;
      ShippedLineDimChangeConfirmed@1003 : Boolean;
    BEGIN
      // Update all lines with changed dimensions.

      IF NewParentDimSetID = OldParentDimSetID THEN
        EXIT;
      IF NOT CONFIRM(Text007) THEN
        EXIT;

      TransLine.RESET;
      TransLine.SETRANGE("Document No.","No.");
      TransLine.LOCKTABLE;
      IF TransLine.FIND('-') THEN
        REPEAT
          NewDimSetID := DimMgt.GetDeltaDimSetID(TransLine."Dimension Set ID",NewParentDimSetID,OldParentDimSetID);
          IF TransLine."Dimension Set ID" <> NewDimSetID THEN BEGIN
            TransLine."Dimension Set ID" := NewDimSetID;

            VerifyShippedLineDimChange(ShippedLineDimChangeConfirmed);

            DimMgt.UpdateGlobalDimFromDimSetID(
              TransLine."Dimension Set ID",TransLine."Shortcut Dimension 1 Code",TransLine."Shortcut Dimension 2 Code");
            TransLine.MODIFY;
          END;
        UNTIL TransLine.NEXT = 0;
    END;

    PROCEDURE GoodsShipped@1280000() : Boolean;
    VAR
      TransLines@1280000 : Record 5741;
    BEGIN
      TransLines.RESET;
      TransLines.SETRANGE("Document No.","No.");
      TransLines.SETFILTER("Quantity Shipped",'>0');
      IF TransLines.FINDFIRST THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    PROCEDURE GetGateEntryLines@1500001();
    BEGIN
      PostedGateEntryLine.MODIFYALL(Mark,FALSE);

      PostedGateEntryLine.RESET;
      PostedGateEntryLine.SETCURRENTKEY("Entry Type","Source Type","Source No.",Status);
      PostedGateEntryLine.SETRANGE("Entry Type",PostedGateEntryLine."Entry Type"::Inward);
      PostedGateEntryLine.SETRANGE("Source Type",PostedGateEntryLine."Source Type"::"Transfer Receipt");
      PostedGateEntryLine.SETRANGE("Source No.","No.");
      PostedGateEntryLine.SETRANGE(Status,PostedGateEntryLine.Status::Open);
      GateEntryAttachment.SETCURRENTKEY("Source Type","Source No.","Entry Type","Gate Entry No.","Line No.");
      IF PostedGateEntryLine.FINDSET THEN
        REPEAT
          GateEntryAttachment.SETRANGE("Source No.",PostedGateEntryLine."Source No.");
          GateEntryAttachment.SETRANGE("Gate Entry No.",PostedGateEntryLine."Gate Entry No.");
          GateEntryAttachment.SETRANGE("Line No.",PostedGateEntryLine."Line No.");
          IF NOT GateEntryAttachment.FINDFIRST THEN BEGIN
            PostedGateEntryLine.Mark := TRUE;
            PostedGateEntryLine.MODIFY;
            COMMIT;
          END;
        UNTIL PostedGateEntryLine.NEXT = 0;

      PostedGateEntryLine.RESET;
      PostedGateEntryLine.SETCURRENTKEY("Entry Type","Source Type","Source No.",Status);
      PostedGateEntryLine.SETRANGE(Mark,TRUE);

      IF PostedGateEntryLine.FINDFIRST THEN BEGIN
        PostedGateEntryLineList.SETTABLEVIEW(PostedGateEntryLine);
        IF PAGE.RUNMODAL(PAGE::"Posted Gate Entry Line List",PostedGateEntryLine) = ACTION::LookupOK THEN BEGIN
          GateEntryAttachment.INIT;
          GateEntryAttachment."Source Type" := PostedGateEntryLine."Source Type";
          GateEntryAttachment."Source No." := PostedGateEntryLine."Source No.";
          GateEntryAttachment."Entry Type" := PostedGateEntryLine."Entry Type";
          GateEntryAttachment."Gate Entry No." := PostedGateEntryLine."Gate Entry No.";
          GateEntryAttachment."Line No." := PostedGateEntryLine."Line No.";
          GateEntryAttachment.INSERT;
        END;
      END;
    END;

    LOCAL PROCEDURE VerifyShippedLineDimChange@71(VAR ShippedLineDimChangeConfirmed@1000 : Boolean);
    BEGIN
      IF TransLine.IsShippedDimChanged THEN
        IF NOT ShippedLineDimChangeConfirmed THEN
          ShippedLineDimChangeConfirmed := TransLine.ConfirmShippedDimChange;
    END;

    BEGIN
    END.
  }
}

